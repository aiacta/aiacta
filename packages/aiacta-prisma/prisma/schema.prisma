datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
  output   = "./"
}

model Player {
  id       String          @id @default(cuid())
  name     String          @unique
  password String
  color    String          @default("white")
  worlds   PlayerInWorld[]
}

model World {
  id       String          @id @default(cuid())
  name     String          @unique
  players  PlayerInWorld[]
  messages ChatMessage[]
}

enum Role {
  GAMEMASTER
  USER
}

model PlayerInWorld {
  player   Player @relation(fields: [playerId], references: [id])
  playerId String
  world    World  @relation(fields: [worldId], references: [id])
  worldId  String

  role Role @default(USER)

  @@id([playerId, worldId])
}

model ChatMessage {
  id        String  @id @default(cuid())
  world     World   @relation(fields: [worldId], references: [id])
  worldId   String
  component String?
  text      String?
}
